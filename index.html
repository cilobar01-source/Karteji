<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Portal KARTEJI • Cilosari Barat</title>
<link rel="icon" href="assets/logo.svg" />
<style>
:root{
  --biru:#0e4c92;--biru2:#1a6ac2;--emas:#f6c445;
  --bg:#0b132b;--text:#f5f7fa;--card:#111928;--line:rgba(255,255,255,.12);
  --muted:#a8b3c7;--shadow:0 8px 32px rgba(0,0,0,.25);
}
body.light{
  --bg:#f7f9fc;--text:#1e293b;--card:#ffffff;
  --line:rgba(0,0,0,.08);--muted:#475569;--shadow:0 4px 18px rgba(0,0,0,.08);
}
*{box-sizing:border-box;transition:.25s ease all}
body{margin:0;font-family:'Poppins',system-ui,Arial;background:var(--bg);color:var(--text);}
a{text-decoration:none;color:inherit}
header{
  display:flex;align-items:center;justify-content:space-between;
  padding:.9rem 1.2rem;position:sticky;top:0;z-index:40;
  background:rgba(17,25,40,0.75);backdrop-filter:blur(12px);
  border-bottom:1px solid var(--line);
}
body.light header{background:rgba(255,255,255,0.7)}
.brand{display:flex;align-items:center;gap:.6rem;font-weight:700}
.brand img{width:40px;height:40px;border-radius:8px}
nav{display:flex;gap:.8rem;align-items:center;flex-wrap:wrap}
.btn{padding:.55rem 1rem;border-radius:12px;font-weight:700;cursor:pointer;border:none}
.btn-primary{background:var(--emas);color:#0b132b}
.btn-outline{background:transparent;border:1px solid var(--emas);color:var(--emas)}
#themeBtn{background:transparent;border:none;font-size:1rem;cursor:pointer}
.poinBox{background:rgba(255,255,255,.08);padding:.35rem .8rem;border-radius:12px;font-size:.9rem;border:1px solid var(--line)}
body.light .poinBox{background:#f2f2f7}

/* Hero */
.hero{padding:4rem 1rem;text-align:center;max-width:760px;margin:auto}
.hero h1{font-size:2.2rem;background:linear-gradient(90deg,var(--emas),#ffd55f);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{font-size:1.05rem;line-height:1.65;color:var(--muted);margin-bottom:2rem}

/* Section umum */
.section{padding:2.2rem 1rem;max-width:1000px;margin:auto}
.section h2{text-align:center;font-size:1.4rem;color:var(--emas);margin-bottom:1.2rem}

/* UMKM horizontal */
.umkm-scroll{display:flex;overflow-x:auto;gap:1rem;scroll-snap-type:x mandatory;padding-bottom:1rem}
.umkm-card{
  flex:0 0 180px;scroll-snap-align:start;background:var(--card);border:1px solid var(--line);
  border-radius:14px;box-shadow:var(--shadow);padding:.8rem;cursor:pointer;text-align:center;
}
.umkm-card img{width:100%;height:140px;object-fit:cover;border-radius:10px;margin-bottom:.4rem}
.umkm-card b{font-size:.95rem;display:block}
.umkm-card span{color:var(--emas);font-weight:700;font-size:.9rem}

/* Footer */
footer{text-align:center;padding:2.5rem 1rem;color:var(--muted);border-top:1px solid var(--line);margin-top:3rem}
.muted{color:var(--muted)}
.hidden{display:none}
</style>
</head>
<body>
<header>
  <div class="brand"><img src="assets/logo.svg"/><span>KARTEJI Portal</span></div>
  <nav>
    <a href="#kegiatan">Kegiatan</a>
    <a href="#berita">Berita</a>
    <a href="#umkm">UMKM</a>
    <a href="#pengumuman">Pengumuman</a>
    <button id="themeBtn">🌓</button>
    <span id="userName" class="hidden"></span>
    <span id="poinUser" class="poinBox hidden">🏅 0 pts</span>
    <a id="loginBtn" href="auth.html" class="btn btn-primary">Masuk / Daftar</a>
    <a id="dashBtn" href="dashboard.html" class="btn btn-outline hidden">Dashboard</a>
    <button id="logoutBtn" class="btn btn-outline hidden">Keluar</button>
  </nav>
</header>

<section class="hero">
  <h1>Portal Digital Karang Taruna<br>Cilosari Barat RT01/RW08</h1>
  <p>💪 Pelatihan, lomba, kegiatan sosial<br>💰 Informasi kas dan iuran<br>🧠 Konten edukatif<br>🏅 Poin & lencana keaktifan</p>
  <a href="auth.html" class="btn btn-primary" id="ctaBtn">🚀 Mulai Sekarang</a>
</section>

<section id="umkm" class="section">
  <h2>🏪 Produk UMKM</h2>
  <div id="umkmList" class="umkm-scroll"></div>
</section>

<section id="kegiatan" class="section">
  <h2>💪 Kegiatan Terbaru</h2>
  <div id="kegiatanList"></div>
</section>

<section id="berita" class="section">
  <h2>📰 Berita Terbaru</h2>
  <div id="beritaList"></div>
</section>

<section id="pengumuman" class="section">
  <h2>📢 Pengumuman</h2>
  <div id="pengumumanList"></div>
</section>

<footer><p>© 2025 KARTEJI Cilosari Barat · 💙 Semarang</p></footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
import { getAuth,onAuthStateChanged,signOut } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
import { getFirestore,collection,getDocs,query,orderBy } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

const firebaseConfig={apiKey:"AIzaSyCgJC8OQBG_wQt57tZHfNuVKPb2VVlAalI",authDomain:"karang-taruna-aadaf.firebaseapp.com",projectId:"karang-taruna-aadaf",storageBucket:"karang-taruna-aadaf.appspot.com",messagingSenderId:"367208001887",appId:"1:367208001887:web:bce5982d99edefb7e746ea"};
const app=initializeApp(firebaseConfig);const auth=getAuth(app);const db=getFirestore(app);
document.getElementById('themeBtn').onclick=()=>document.body.classList.toggle('light');

async function loadUmkm(){
  const snap=await getDocs(query(collection(db,'umkm'),orderBy('createdAt','desc')));
  const c=document.getElementById('umkmList');
  c.innerHTML='';
  if(snap.empty){c.innerHTML='<p class="muted">Belum ada produk.</p>';return;}
  snap.forEach(d=>{
    const u=d.data(), id=d.id;
    const foto=Array.isArray(u.foto)?u.foto[0]:u.foto;
    const el=document.createElement('div');
    el.className='umkm-card';
    el.innerHTML=`${foto?`<img src="${foto}">`:''}<b>${u.produk||'(Tanpa nama)'}</b><span>Rp ${(u.harga||0).toLocaleString('id-ID')}</span>`;
    el.onclick=()=>location.href=`umkm.html?id=${id}`;
    c.appendChild(el);
  });
}

async function loadKegiatan(){
  const snap=await getDocs(query(collection(db,'kegiatan'),orderBy('createdAt','desc')));
  const c=document.getElementById('kegiatanList');
  c.innerHTML='';
  snap.forEach(d=>{
    const k=d.data();
    c.innerHTML+=`<div class="item"><b>${k.judul||'(Tanpa judul)'}</b><p>${k.deskripsi||''}</p></div>`;
  });
}
async function loadBerita(){
  const snap=await getDocs(query(collection(db,'berita'),orderBy('createdAt','desc')));
  const c=document.getElementById('beritaList');
  c.innerHTML='';
  snap.forEach(d=>{
    const b=d.data(),id=d.id;
    const f=Array.isArray(b.foto)?b.foto[0]:b.foto;
    c.innerHTML+=`<div class="item"><a href="berita.html?id=${id}">${f?`<img src="${f}">`:''}<b>${b.judul||''}</b></a></div>`;
  });
}
async function loadPengumuman(){
  const snap=await getDocs(query(collection(db,'pengumuman'),orderBy('createdAt','desc')));
  const c=document.getElementById('pengumumanList');c.innerHTML='';
  snap.forEach(d=>{const p=d.data();c.innerHTML+=`<div class="item"><b>${p.judul||''}</b><p>${p.isi||''}</p></div>`});
}
onAuthStateChanged(auth,()=>{loadUmkm();loadKegiatan();loadBerita();loadPengumuman();});
</script>
</body>
</html>
